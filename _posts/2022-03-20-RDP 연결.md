---
layout: post
post-image: "/assets/images/imgs/RDP_logo.png"
title:  "#2 RDP 셋업 A to Z"
date:   2022-03-20 20:36:16 +0900
categories: RDP, 윈도우, Window
tags:
- GAPM-7100
- Parsec
- RDP
- RDP 에러
- RDP 오류
- WOL
- 갤럭시탭 원격
- 갤럭시탭 컴퓨터
- 아이패드 원격
- 아이패드 컴퓨터
- 원격 검은화면
- 원격 접속 에러
- 원격 접속 오류
- 원격데스크탑
- 유플러스
- 인터넷
- 크롬데스크탑
- 원격
---
# RDP

<aside>
💡 Remote Desktop Protocol의 약자로, 마이크로소프트에서 제공하는 윈도우의 기능이다.
<hr>
</aside>

  태블릿을 들고 다니면서 급하게 컴퓨터 프로그램(예컨대, VSCode와 같은!)을 사용하거나 데스크탑에 저장해두었던 파일이 필요한 순간에 접속해서 활용하기 위해 적용했다. 해당 기능은 안드로이드, iOS, 윈도우와 무관하게 사용할 수 있어 다양한 기기의 연결성을 높여준다.

  원격 접속은 크롬 데스크탑 원격 접속이나 Parsec과 같은 서드파티 프로그램을 사용해도 충분하지만, 본인의 경우 RDP를 사용하면 단축키 등을 그대로 사용할 수 있다는 장점이 있어 조금 불편함에도 RDP를 사용하는 편이다.

  그렇다면 RDP 설정부터 실행까지 어떻게 진행하는지 한 번 살펴보자!

<br>

## 필요 사항

### 윈도우 ~ Professional

  RDP를 활용하기 위해서는 몇 가지가 필요하다. 연결하려는 서버 컴퓨터가 윈도우 프로여야 한다. 홈에서도 편법으로 활용할 수 있다고는 하지만, 아무래도 여러 에러가 발생한다는 이야기가 있다. 아무튼 윈도우에서는 공식적으로 Professional 등급에서만 지원한다.

### WOL

<aside>
💡 WOL(Wake on LAN)은 전원이 꺼진 컴퓨터에 네트워크 메시지를 보내 전원을 켜거나 절전 모드에서 깨어나게 하는 기능이다.
<hr>
</aside>

  WOL을 활용하기 위해서는 **원격으로 접속할 컴퓨터가 유선랜으로 데스크탑과 연결**이 되어 있어야 하고, 메인보드에서 해당 기능을 지원해야 한다.

<br>

  WOL 설정은 어렵지 않아 금방 적용할 수 있다. 바이오스 설정으로 들어가 메인보드에서 해당 기능을 켤 수 있는데, MSI 메인보드를 기준으로 `Advanced-Power On By PCI-E`를 Enable 하면 메인보드 설정은 끝이다.

*(PCI, PCIE, Wake on LAN 등의 이름으로 되어 있는 경우도 있다.)*

<br>

  이후 공유기에 해당 기기를 등록해주어야 한다.

### 공유기 설정

![RDP_01]("/assets/images/imgs/#2_RDP/RDP_02.jpg")

  필자는 유플러스 공유기를 사용 중이므로, 해당 기기를 기준으로 설명하겠다. (iptime 또한 크게 다르지 않을 것이다.)

  설정을 위해서는 본인의 공유기 아이피 주소로 들어가면 된다. 혹시 잘 모른다면 `Windows + R`을 누르고 `cmd`를 입력해주면 명령 프롬프트가 켜진다. 해당 프롬프트에서 `ipconfig`을 입력하면 인터넷 연결과 관련한 정보가 나타나는데, 해당 부분에서 `IPv4 주소`를 인터넷 주소 창에 입력하면 공유기 관리자 화면으로 접속할 수 있다.

  공유기 관리자 비밀번호는 공유기 상단 또는 하단에 기입되어 있다.

<br>

  공유기 설정 단계는 크게 두 개로 구분된다.

<hr>

**1. 외부에서 접속 가능하게끔 설정**
  1. ***고정 IP***
      
      ![RDP_02]("/assets/images/imgs/#2_RDP/RDP_03.jpg")
      
        고정 IP를 설정하지 않으면 IP 주소가 변동되어 외부에서 접속할 때 불편하다. 외부에서 보다 원활하게 접속을 하기 위해 네트워크 설정 - 유선 네트워크로 이동해 고정 IP를 사용한다고 체크하면 된다.
      
  2. ***포트포워딩***
      
      ![RDP_03]("/assets/images/imgs/#2_RDP/RDP_04.jpg")
      
        포트포워딩과 관련하여 자세한 설명을 하자면 너무 길기 때문에 간략하게 말하면 ‘호텔 방 번호’와 같다고 생각하면 된다. 외부 IP 주소는 호텔 주소와 같은데, 호텔 주소만으로는 내 방을 찾아갈 순 없는 것처럼 호텔 방 번호가 바로 포트포워딩이라고 생각하면 쉽다.
      
      **RDP를 위해서 NAT 설정 - 포트포워딩으로 이동해 추가 버튼을 누르고 `3389-3389`로 입력해주면 된다. (혹은 `3389`)**
      
        *처음 잘 모를 때 SuperDMZ가 키기만 하면 되어서 사용했으나, 심각한 인터넷 속도 저하와 가끔 원인 모를 인터넷 먹통 현상이 있어 포트포워딩으로 설정했다.*
        
**2. WOL, 원격제어와 관련한 설정**
  1. ***WOL***
      
      ![RDP_04]("/assets/images/imgs/#2_RDP/RDP_05.jpg")
      
        해당 기능을 입력하는 것은 무척 쉽다. 네트워크 설정-세부 설정으로 이동해 Wake on LAN에 본인 컴퓨터의 MAC 주소(아마 대부분 모를텐데, 그냥 속 편하게 ‘현재 접속된 PC의 MAC주소로 설정’을 누르면 알아서 입력해준다.
      
      ~~*알잘딱 최고*~~
      
        추가로 PC 설명을 입력해두면 어떤 PC인지 보다 명확하게 알 수 있어 하나 밖에 없더라도 설정하는 것을 추천한다.
      
  2. ***원격제어***
      
      ![RDP_05]("/assets/images/imgs/#2_RDP/RDP_06.jpg")
      
        네트워크 설정-세부 설정을 들어가면 제일 먼저 보이는 화면이다. `사용함`을 켜주고, 포트 설정을 88로 하면 된다. `사용함`을 켜면 Default 값이 88이므로 별도 입력 없이 설정 적용을 눌러 설정을 저장해주면 된다.
        

<hr>

### 윈도우 설정

  정말. 정말정말. 정말정말정말 중요한 부분이다. 아무리 메인보드와 공유기에서 설정을 해주었다고 해도 정작 윈도우 설정이 제대로 되지 않으면 RDP는 동작하지 않는다. 실제로 이 탓에 몇 개월 동안 왜 안되는건가 고민만 했다. ~~*RDP 프로토콜 활성화를 안했었다.*~~

1. **RDP 프로토콜**
    
      아마 접속이 안되는 많은 분이 RDP 프로토콜이 설정하지 않아서 모든 설정을 끝마쳤음에도 안된다고 할 것이다.
    
      관련 정보를 찾아보다가 우연히 발견한 [MS 공식 문서]([https://docs.microsoft.com/ko-kr/windows-server/remote/remote-desktop-services/troubleshoot/rdp-error-general-troubleshooting](https://docs.microsoft.com/ko-kr/windows-server/remote/remote-desktop-services/troubleshoot/rdp-error-general-troubleshooting))가 그 해답을 알려줬다.
    
      역시 무언가를 알아볼 때는 공식 문서를 참조하는 것이 최고다.
    
    <br>
    
2. **TCP 프로토콜 (Option)**
    
      해당 프로토콜은 굳이 설정하지 않아도 된다. 다만, 본인은 TCP 프로토콜을 설정하지 않았을 때 RDP 연결을 하면 바탕화면이 검은색으로 나오는게 싫어서 설정했다.
    
      RDP 연결에는 두 종류가 있는데, UDP와 TCP가 있다. UDP는 신호절차를 거치지 않아 TCP보다 속도가 빠르지만 비연결형 서비스인 탓에 데이터그램 방식을 제공한다. 반면 TCP는 스트림 전송이므로 전송 데이터 크기가 무제한이고, 패킷에 대해 응답을 해야 하므로 UDP에 비해 성능이 낮은 것이 특징이다.
    
      다만 앞서 이야기했듯, UDP로 연결하게 된다면 바탕화면이 검은색으로 나타나는데, 예쁜 배경화면을 설정해놓았기에.. 본인은 TCP를 더 선호한다. ~~지극히 단순한 이유~~
    
    <br>
    
      연결 방법을 위해서 `Windows + R` → `gpedit.msc`를 입력해 로컬 그룹 정책 편집기를 실행해야 한다. 로컬 그룹 정책 편집기가 실행되었다면 컴퓨터 구성 → 관리 템플릿 → Windows 구성 요소 → 터미널 서비스 → 원격 데스크톱 세션 호스트 → 연결로 이동하면 된다.
    
      해당 위치로 이동한 다음 `Select RDP transport protocol(RDP 전송 프로토콜 선택)`을 더블클릭하고 `사용`을 누른 다음 `Use only TCP(TCP만 사용)`눌러주고 확인을 누르면 된다. 다만, 이렇게 되면 TCP 연결만을 진행하기 때문에 속도는 다소 느려질 수 있다.
    
    <br>
    
3. **서비스**
    
      서비스 설정은 `Windows + R`을 입력한 다음 `services.msc`을 입력해주면 서비스 설정과 관련한 창이 켜진다. ‘**이름**’을 눌러 이름 순으로 정렬시킨 다음 `Remote Desktop Services` 항목을 찾아 사용함으로 변경한 다음 시작 유형을 **자동**으로 설정해주면 끝이다.
    
      해당 값을 변경하는 방법은 `Remote Desktop Services`를 더블클릭하면 된다.
    
    <br>
    
4. **방화벽**
    
      길고 긴 설정의 끝이 보이기 시작했다. 설정-방화벽 및 네트워크 보호-방화벽에서 앱 허용으로 들어가 `원격 데스크톱`, `원격 지원`을 개인, 공용에 모두 체크해주면 된다.
    
      모두 체크해주고 난 뒤에는 제어판-시스템 및 보안-시스템에서 좌측에 위치한 원격 설정을 눌러 `이 컴퓨터에 대한 원격 지원 연결 허용`을 체크해주고, `이 컴퓨터에 대한 원격 연결 허용`을 눌러주기만 하면 된다.
    
    + 추가로 설정-시스템-원격 데스크톱에서 `원격 데스크톱 활성화`도 켜주면 된다.
    
      모든 설정을 끝마친 이후에는 재부팅하면 된다.
    

---

## How to connect?

  모든 설정을 마치고 나면 연결은 쉽다. 접속을 할 클라이언트 기기에서 인터넷을 켜고 주소창에 [나의 외부 IP](https://search.naver.com/search.naver?query=%EB%82%B4+%EC%95%84%EC%9D%B4%ED%94%BC):88을 입력한 다음 로그인을 하고 WOL로 서버 컴퓨터를 실행하면 원격으로 컴퓨터를 꺼져있는 컴퓨터를 실행할 수 있다.

  그리고 난 뒤 원격 접속을 시도할 클라이언트 기기에서 RDP를 실행하면 된다. 윈도우 컴퓨터의 경우 별도 설치없이 `Windows` 버튼을 누르고 `RDP`라고 입력하면 원격 데스크톱 연결이 나타난다. 안드로이드, Mac, iOS의 경우 앱스토어에서 RDP를 다운로드 받아주면 된다.

<br>

  RDP를 실행하면 `컴퓨터(C):` 와 `사용자 이름:` 을 입력하라고 나타날 것이다. 컴퓨터 이름은 아까 설정했던 [나의 외부 IP](https://search.naver.com/search.naver?query=%EB%82%B4+%EC%95%84%EC%9D%B4%ED%94%BC)를 입력하고, 그 뒤에 `:3389`를 입력하면 된다.

*e.g. `127.0.0.1:3389`* 

  사용자 이름은 본인이 알고 있는 경우 해당 이름을 입력하면 되지만, 잘 모르는 경우가 많을 것이다. 원격 접속을 당할 서버 컴퓨터에서 명령 프롬프트(`Windows + R` → `cmd`)를 켜 `whoami`를 입력하면 사용자 이름을 알 수 있는데, 해당 내용을 그대로 입력하면 된다.

  처음 접속할 때 자격 증명 기억하기를 활성화시키면 다음에 접속할 때는 별도의 입력없이 클릭만으로 쉽게 접속할 수 있다.

---

### References

[https://comeinsidebox.com/wol-remotely-computer-on-router-wake-on-lan-use/](https://comeinsidebox.com/wol-remotely-computer-on-router-wake-on-lan-use/)

[[Windows 10] RDP 원격 접속 설정 "확인 사항"](https://security-nanglam.tistory.com/470)

[원격 데스크톱(RDP) 연결시 검은 화면 해결: TCP 프로토콜 강제](https://msm8994.tistory.com/45)

[일반 원격 데스크톱 연결 문제 해결](https://docs.microsoft.com/ko-kr/windows-server/remote/remote-desktop-services/troubleshoot/rdp-error-general-troubleshooting)